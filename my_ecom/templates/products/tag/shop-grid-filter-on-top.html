{% extends 'base/base-code.html' %}
{% load static %}
{% block title %}Shop Grid{% endblock title %}
{% block main-content %}
	<!--start page wrapper -->
	<div class="page-wrapper">
		<div class="page-content">
			<!--start breadcrumb-->
			<section class="py-3 border-bottom border-top d-none d-md-flex bg-light">
				<div class="container">
					<div class="page-breadcrumb d-flex align-items-center">
						<h3 class="breadcrumb-title pe-3">Shop Grid Filter On Top</h3>
						<div class="ms-auto">
							<nav aria-label="breadcrumb">
								<ol class="breadcrumb mb-0 p-0">
									<li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i> Home</a>
									</li>
									<li class="breadcrumb-item"><a href="javascript:;">Shop</a>
									</li>
									<li class="breadcrumb-item active" aria-current="page">Shop Grid Filter Top</li>
								</ol>
							</nav>
						</div>
					</div>
				</div>
			</section>
			<!--end breadcrumb-->
			<!--start shop area-->
			<section class="py-4">
				<div class="container">
					<div class="row">
						<div class="col-12 col-xl-12">
							<div class="product-wrapper">
								<div class="toolbox d-lg-flex align-items-center mb-3 gap-2 p-3 bg-white border">
									<form method="get" class="toolbox d-lg-flex align-items-center mb-3 gap-2 p-3 bg-white border">

										{# ==== Hidden: sidebar/other filter preserve ==== #}
										{% for bid in selected_brand_ids %}
											<input type="hidden" name="brand" value="{{ bid }}">
										{% endfor %}

										{% for cid in selected_color_ids %}
											<input type="hidden" name="color" value="{{ cid }}">
										{% endfor %}

										{% if min_price %}
											<input type="hidden" name="min_price" value="{{ min_price }}">
										{% endif %}
										{% if max_price %}
											<input type="hidden" name="max_price" value="{{ max_price }}">
										{% endif %}
										{% if selected_discount %}
											<input type="hidden" name="discount" value="{{ selected_discount }}">
										{% endif %}

										<input type="hidden" name="view" value="{{ view_type }}">

										{# ====== Left side filters (Size, Color, Price, Sort, Search) ====== #}
										<div class="d-flex flex-wrap flex-grow-1 gap-1">

											{# Size filter #}
											<div>
												<select name="size" class="form-select rounded-0">
													<option value="">Size</option>
													{% for s in sizes %}
														<option value="{{ s.id }}"
															{% if selected_size|stringformat:'s' == s.id|stringformat:'s' %}selected{% endif %}>
															{{ s.name }}
														</option>
													{% endfor %}
												</select>
											</div>

											{# Top color filter (category er moto top_color use korte chaile name="top_color" koro) #}
											<div>
												<select name="top_color" class="form-select rounded-0">
													<option value="">Color</option>
													{% for c in colors %}
														<option value="{{ c.id }}"
															{% if top_color|stringformat:'s' == c.id|stringformat:'s' %}selected{% endif %}>
															{{ c.name }}
														</option>
													{% endfor %}
												</select>
											</div>

											{# Price range #}
											<div>
												<select name="price_range" class="form-select rounded-0">
													<option value="">Price</option>
													<option value="5-49"   {% if price_range == '5-49' %}selected{% endif %}>$5 to $49</option>
													<option value="49-99"  {% if price_range == '49-99' %}selected{% endif %}>$49 to $99</option>
													<option value="99-149" {% if price_range == '99-149' %}selected{% endif %}>$99 to $149</option>
													<option value="149-300"{% if price_range == '149-300' %}selected{% endif %}>$149 to $300</option>
													<option value="300-500"{% if price_range == '300-500' %}selected{% endif %}>$300 to $500</option>
													<option value="1000+"  {% if price_range == '1000+' %}selected{% endif %}>Above $1000</option>
												</select>
											</div>

											{# Sort #}
											<div class="d-flex align-items-center flex-nowrap">
												<select name="sort" class="form-select rounded-0">
													<option value="" {% if not selected_sort %}selected{% endif %}>Default sorting</option>
													<option value="newest"     {% if selected_sort == 'newest' %}selected{% endif %}>Sort by newness</option>
													<option value="price_asc"  {% if selected_sort == 'price_asc' %}selected{% endif %}>Sort by price: low to high</option>
													<option value="price_desc" {% if selected_sort == 'price_desc' %}selected{% endif %}>Sort by price: high to low</option>
												</select>
											</div>

											<div>
												<button type="submit" class="btn btn-dark rounded-0 text-uppercase">
													Search
												</button>
											</div>
										</div>

										{# ====== Show (per_page) ====== #}
										<div class="d-flex flex-wrap">
											<div class="d-flex align-items-center flex-nowrap">
												<p class="mb-0 font-13 text-nowrap">Show:</p>
												<select name="per_page" class="form-select ms-3 rounded-0">
													{% for num in per_page_list %}
														<option value="{{ num }}" {% if per_page|stringformat:'s' == num|stringformat:'s' %}selected{% endif %}>
															{{ num }}
														</option>
													{% endfor %}
												</select>
											</div>
										</div>

										{# ====== View toggle ====== #}
										<div class="d-flex gap-2">
											<div>
												<a href="?view=left" class="btn {% if view_type == 'left' %}btn-dark{% else %}btn-light{% endif %} rounded-0">
													<i class='bx bxs-grid me-0'></i>
												</a>
											</div>
											<div>
												<a href="?view=list" class="btn {% if view_type == 'list' %}btn-dark{% else %}btn-light{% endif %} rounded-0">
													<i class='bx bx-list-ul me-0'></i>
												</a>
											</div>
										</div>

									</form>


								</div>
								<div class="product-grid">
									<div class="row row-cols-2 row-cols-md-3 row-cols-lg-3 row-cols-xl-4 row-cols-xxl-5 g-3 g-sm-4">
										{% for product in products %}
										<div class="col">
											
											<div class="card">
												
												<div class="position-relative overflow-hidden">
													<div class="add-cart position-absolute top-0 end-0 mt-3 me-3">
														<a href="javascript:;" onclick="handleProductAction('{{ product.id }}', 'cart')">
															<i class='bx bx-cart-add'></i>
														</a>
														</div>
													<div class="quick-view position-absolute start-0 bottom-0 end-0">
													<a href="javascript:;" 
													class="btn btn-sm btn-dark quick-view-btn"
													data-bs-toggle="modal"
													data-bs-target="#QuickViewProduct"
													data-slug="{{ product.slug }}">
													Quick View
													</a>
													</div>
													<a href="{% url 'product-detail' product.slug %}">
													{% with first_image=product.images.first %}
														{% if first_image %}
															<img src="{{ first_image.image.url }}" class="img-fluid" alt="{{ product.title }}">
														{% else %}
															<img src="/path/to/default-image.jpg" class="img-fluid" alt="No Image">
														{% endif %}
													{% endwith %}

													</a>
												</div>
												<div class="card-body px-0">
													<div class="d-flex align-items-center justify-content-between">
														<div class="">
															<p class="mb-1 product-short-name">Topwear</p>
															<a href="{% url 'product-detail' product.slug %}"><h6 class="mb-0 fw-bold product-short-title">{{ product.title }}</h6></a>
														</div>
														<div class="icon-wishlist">
															<a href="javascript:;" onclick="handleProductAction('{{ product.id }}', 'wishlist')">
																<i class="bx bx-heart"></i>
															</a>
														</div>
													</div>
													<div class="cursor-pointer rating mt-2">
														<i class="bx bxs-star text-warning"></i>
														<i class="bx bxs-star text-warning"></i>
														<i class="bx bxs-star text-warning"></i>
														<i class="bx bxs-star text-warning"></i>
														<i class="bx bxs-star text-warning"></i>
													</div>
													<div class="product-price d-flex align-items-center justify-content-start gap-2 mt-2">
														{% if product.discount_price %}
														<div class="h6 fw-light fw-bold text-secondary text-decoration-line-through">
															${{ product.price }}
														</div>
														<div class="h6 fw-bold text-danger">
															${{ product.orginal_price }}
														</div>
														{% else %}
														<div class="h6 fw-bold">${{ product.price }}</div>
														{% endif %}
													</div>
												</div>
												
											</div>
											
										</div>
										{% empty %}
											<p>No products found in this tag.</p>
										{% endfor %}
									</div><!--end row-->
								</div>
								<hr>
								<nav class="d-flex justify-content-between" aria-label="Page navigation">
									<ul class="pagination">
										<li class="page-item"><a class="page-link" href="javascript:;"><i class='bx bx-chevron-left'></i> Prev</a>
										</li>
									</ul>
									<ul class="pagination">
										<li class="page-item active d-none d-sm-block" aria-current="page"><span class="page-link">1<span class="visually-hidden">(current)</span></span>
										</li>
										<li class="page-item d-none d-sm-block"><a class="page-link" href="javascript:;">2</a>
										</li>
										<li class="page-item d-none d-sm-block"><a class="page-link" href="javascript:;">3</a>
										</li>
										<li class="page-item d-none d-sm-block"><a class="page-link" href="javascript:;">4</a>
										</li>
										<li class="page-item d-none d-sm-block"><a class="page-link" href="javascript:;">5</a>
										</li>
									</ul>
									<ul class="pagination">
										<li class="page-item"><a class="page-link" href="javascript:;" aria-label="Next">Next <i class='bx bx-chevron-right'></i></a>
										</li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
					<!--end row-->
				</div>
			</section>
			<!--end shop area-->
		</div>
	</div>
	<!--end page wrapper -->
{% endblock main-content %}